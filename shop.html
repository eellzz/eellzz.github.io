<!DOCTYPE html>
<html lang="lv">
<head class="store">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Piegāde - Veikals</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/shop.css">
</head>
<body class="store">
    <div class="cart-icon-container">
        <img src="images/grozs.png" alt="Cart" class="cart-icon" id="cartButton">
        <div class="cart-count">0</div>
    </div>
    <div id="cartModal" class="cart-modal">
        <div class="cart-details">
            <h2>Grozs</h2>
            <ul id="cartItemsList"></ul>
            <div class="cart-buttons">
                <button onclick="closeCart()">Atpakaļ</button>
                <button class="checkout-button" onclick="openCheckout()">Noformēt pasūtījumu</button>
            </div>
        </div>
    </div>
    <div id="checkoutModal" class="cart-modal">
        <div class="cart-details">
            <h2>Noformēt pasūtījumu</h2>
            <p>Kopējā cena: <span id="totalPrice"></span></p>
            <p>Kopējais svars: <span id="totalWeight"></span> kg</p>
            <label for="city">Izvēlies pilsētu:</label>
            <select id="city" onchange="updateFinalPrice()">
                <option value="riga">Rīga</option>
                <option value="jurmala">Jūrmala</option>
                <option value="pinki">Piņķi</option>
                <option value="marupe">Mārupe</option>
                <option value="sigulda">Sigulda</option>
                <option value="liepaja">Liepāja</option>
                <option value="ventspils">Ventspils</option>
                <option value="valmiera">Valmiera</option>
            </select>
            <br>
            <label for="deliveryDays">Izvēlies piegādes ātrumu:</label>
            <select id="deliveryDays" onchange="updateFinalPrice()">
                <option value="1">1 diena</option>
                <option value="3">3 dienas</option>
                <option value="7">7 dienas</option>
            </select>
            <br>
            <label for="address">Adrese:</label>
            <input type="text" id="address" placeholder="Ievadiet adresi">
            <p>Piegādes cena: <span id="deliveryPrice"></span></p>
            <p>Kopējā summa: <span id="finalPrice"></span></p>
            <div class="cart-buttons">
                <button onclick="closeCheckout()">Atpakaļ</button>
                <button class="checkout-button" onclick="completePurchase()">Veikt pirkumu</button>
            </div>
        </div>
    </div>
    <div class="store-section">
        <h1>Izveido pasūtījumu</h1>
        <a href="index.html" class="back-button">Atgriezties uz sākumlapu</a>
        <div class="products-grid">
            <div class="product">
                <img src="images/piens1.png" alt="Piens 1">
                <p>Piens 1</p>
                <span class="price">€2.99</span>
                <span class="weight">1</span>
                <button class="add-to-cart" onclick="addToCart('Piens 1', '2.99', 1)">+</button>
            </div>
            <div class="product">
                <img src="images/piens2.png" alt="Piens 2">
                <p>Piens 2</p>
                <span class="price">€5.99</span>
                <span class="weight">1</span>
                <button class="add-to-cart" onclick="addToCart('Piens 2', '5.99', 1)">+</button>
            </div>
            <div class="product">
                <img src="images/piens3.png" alt="Piens 3">
                <p>Piens 3</p>
                <span class="price">€0.99</span>
                <span class="weight">0.5</span>
                <button class="add-to-cart" onclick="addToCart('Piens 3', '0.99', 0.5)">+</button>
            </div>
            <div class="product">
                <img src="images/cepumi1.png" alt="Cepumi 1">
                <p>Cepumi 1</p>
                <span class="price">€0.99</span>
                <span class="weight">0.2</span>
                <button class="add-to-cart" onclick="addToCart('Cepumi 1', '0.99', 0.2)">+</button>
            </div>
            <div class="product">
                <img src="images/cepumi2.png" alt="Cepumi 2">
                <p>Cepumi 2</p>
                <span class="price">€2.99</span>
                <span class="weight">0.3</span>
                <button class="add-to-cart" onclick="addToCart('Cepumi 2', '2.99', 0.3)">+</button>
            </div>
            <div class="product">
                <img src="images/cepumi3.png" alt="Cepumi 3">
                <p>Cepumi 3</p>
                <span class="price">€8.50</span>
                <span class="weight">0.5</span>
                <button class="add-to-cart" onclick="addToCart('Cepumi 3', '8.50', 0.5)">+</button>
            </div>
            <div class="product">
                <img src="images/cola.jpg" alt="Cola">
                <p>Cola</p>
                <span class="price">€4.45</span>
                <span class="weight">2</span>
                <button class="add-to-cart" onclick="addToCart('Cola', '4.45', 2)">+</button>
            </div>
            <div class="product">
                <img src="images/sprite.jpg" alt="Sprite">
                <p>Sprite</p>
                <span class="price">€3.99</span>
                <span class="weight">1.5</span>
                <button class="add-to-cart" onclick="addToCart('Sprite', '3.99', 1.5)">+</button>
            </div>
            <div class="product">
                <img src="images/fanta.jpg" alt="Fanta">
                <p>Fanta</p>
                <span class="price">€0.99</span>
                <span class="weight">0.5</span>
                <button class="add-to-cart" onclick="addToCart('Fanta', '0.99', 0.5)">+</button>
            </div>
            <div class="product">
                <img src="images/sokolade1.png" alt="Sokolade 1">
                <p>Sokolade 1</p>
                <span class="price">€4.99</span>
                <span class="weight">0.1</span>
                <button class="add-to-cart" onclick="addToCart('Sokolade 1', '4.99', 0.1)">+</button>
            </div>
            <div class="product">
                <img src="images/sokolade2.png" alt="Sokolade 2">
                <p>Sokolade 2</p>
                <span class="price">€7.00</span>
                <span class="weight">0.2</span>
                <button class="add-to-cart" onclick="addToCart('Sokolade 2', '7.00', 0.2)">+</button>
            </div>
            <div class="product">
                <img src="images/sokolade3.png" alt="Sokolade 3">
                <p>Sokolade 3</p>
                <span class="price">€6.75</span>
                <span class="weight">0.15</span>
                <button class="add-to-cart" onclick="addToCart('Sokolade 3', '6.75', 0.15)">+</button>
            </div>
        </div>
    </div>

    <script>
        let cart = [];

        function addToCart(productName, price, weight) {
            cart.push({ name: productName, price: parseFloat(price), weight: parseFloat(weight) });
            document.getElementById('cartItemsList').innerHTML += `<li>${productName} - €${price} (${weight} kg)</li>`;
            updateCartCount();
        }

        function updateCartCount() {
            const count = cart.length;
            document.querySelector('.cart-count').innerText = count;
        }

        function openCart() {
            document.getElementById('cartModal').style.display = 'flex';
        }

        function closeCart() {
            document.getElementById('cartModal').style.display = 'none';
        }

        function openCheckout() {
            closeCart();
            const totalPrice = cart.reduce((sum, item) => sum + item.price, 0);
            const totalWeight = cart.reduce((sum, item) => sum + item.weight, 0);
            document.getElementById('totalPrice').innerText = `€${totalPrice.toFixed(2)}`;
            document.getElementById('totalWeight').innerText = totalWeight.toFixed(2);
            updateFinalPrice();
            document.getElementById('checkoutModal').style.display = 'flex';
        }

        function closeCheckout() {
            document.getElementById('checkoutModal').style.display = 'none';
        }

        function updateFinalPrice() {
            const totalWeight = cart.reduce((sum, item) => sum + item.weight, 0);
            const deliveryDays = document.getElementById('deliveryDays').value;
            const city = document.getElementById('city').value;
            let deliveryPrice = 0;

            const rigaNearby = ["riga", "jurmala", "pinki", "marupe"];
            const otherCities = ["sigulda", "liepaja", "ventspils", "valmiera"];

            // Piegādes cena atkarībā no piegādes ātruma un attāluma
            if (deliveryDays == 1) {
                deliveryPrice += rigaNearby.includes(city) ? 15 : 20;
            } else if (deliveryDays == 3) {
                deliveryPrice += rigaNearby.includes(city) ? 10 : 15;
            } else if (deliveryDays == 7) {
                deliveryPrice += rigaNearby.includes(city) ? 5 : 10;
            }

            // Piegādes cena atkarībā no svara
            if (totalWeight <= 5) {
                deliveryPrice += 1;
            } else if (totalWeight <= 10) {
                deliveryPrice += 2;
            } else {
                deliveryPrice += 3;
            }

            const totalPrice = cart.reduce((sum, item) => sum + item.price, 0);
            const finalPrice = totalPrice + deliveryPrice;

            document.getElementById('deliveryPrice').innerText = `€${deliveryPrice.toFixed(2)}`;
            document.getElementById('finalPrice').innerText = `€${finalPrice.toFixed(2)}`;
        }

        function completePurchase() {
            const city = document.getElementById('city').value;
            const address = document.getElementById('address').value;

            if (address.trim() === "") {
                alert("Lūdzu, ievadiet adresi.");
                return;
            }

            alert(`Pirkums veiksmīgs! Piegāde uz ${address}, ${city}.`);
            cart = [];
            document.getElementById('cartItemsList').innerHTML = '';
            updateCartCount();
            closeCheckout();
        }

        document.getElementById('cartButton').addEventListener('click', openCart);
    </script>
</body>
</html>
